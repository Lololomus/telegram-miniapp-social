/* css/modals.css */

/* --- СТИЛИ: МОДАЛЬНОЕ ОКНО QR-КОДА --- */
.modal-overlay {
    position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.6);
    display: none; align-items: center; justify-content: center; z-index: 1000; padding: 20px;
}
.modal-content {
    background-color: var(--main-bg-color, var(--tg-theme-bg-color, #ffffff));
    padding: 25px; border-radius: 14px; text-align: center; max-width: 90%;
    box-shadow: 0 5px 25px rgba(0, 0, 0, 0.15);
    transition: background-color 0.3s, border-color 0.3s, box-shadow 0.3s;
}
#qrcode-output {
    margin: 20px auto; width: 200px; height: 200px; background-color: white;
    padding: 10px; border-radius: 8px; display: flex; align-items: center; justify-content: center;
}
#qrcode-output img { display: block; max-width: 100%; max-height: 100%; }
#qr-link-display {
    font-size: 12px; color: var(--main-hint-color, var(--tg-theme-hint-color, #999999));
    opacity: var(--main-hint-opacity, 1); word-break: break-all; margin-bottom: 20px;
}
.modal-content .action-button.secondary { margin-top: 15px; }

/* --- Стили для модального окна навыков (HTML) --- */
#skills-modal {
  display: flex;
  flex-direction: column;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  height: 100dvh;
  height: 100vh;
  z-index: 1001;
  padding: var(--modal-header-offset) var(--screen-padding-x) 0;
  overflow-y: auto;
  background-color: var(--main-bg-color, var(--tg-theme-bg-color, #ffffff));
  transition: background-color 0.3s;
}

@media (min-width: 700px) {
  #skills-modal {
    max-width: 600px;
    margin: 0 auto;
    left: 0;
    right: 0;
  }
}

#skills-modal .form-header {
  padding: 0 0 6px 0;
  margin-bottom: 8px;
  flex-shrink: 0;
  text-align: center;
}
#skills-modal > .status-filter-group,
#skills-modal-list-container {
  max-width: 600px;
  width: 100%;
  margin: 0 auto;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  gap: var(--skills-section-gap-y);
}

/* 1. Контейнер со списком навыков (Языки, Фронтенд и т.д.) */
#skills-modal-list-container {
  padding: 0 16px 100px 16px;
}

/* 2. Группа фильтров (Тип запроса) */
#skills-modal > .status-filter-group {
  padding: 0 16px;
  margin-bottom: 24px;
}

.skill-category { margin: 0; padding: 0; }
.skill-category:last-child { margin-bottom: 0; }
.skill-category-title {
    font-size: 15px; font-weight: 600;
    color: var(--main-hint-color, var(--tg-theme-hint-color, #999999));
    margin: 0 0 2px 0; padding-bottom: 8px; border-bottom: none;
}

.skill-list {
  display: flex;
  flex-wrap: wrap;
  gap: var(--skills-tags-gap);
}

.fab-modal-save-container {
    position: fixed;
    bottom: 25px;
    left: 50%;
    transform: translateX(-50%);
    width: calc(100% - 40px);
    max-width: 560px;
    z-index: 1001;
}

.action-button.fab-modal-save {
    width: 100%;
    animation: fab-pulse-main 2.5s infinite ease-in-out;
    padding: 14px;
    position: relative;
    left: auto;
    bottom: auto;
    transform: none; 
}

/* --- Фильтр статусов --- */
.status-filter-group {
  padding: 0 16px 0 16px;
  margin-bottom: var(--skills-section-gap-y);
  border-bottom: none;
  transition: border-color 0.3s;
}
.status-filter-group-title {
    font-size: 15px;
    font-weight: 600;
    color: var(--main-hint-color, var(--tg-theme-hint-color, #999999));
    margin: 0 0 12px 0;
}
.status-filter-list {
  display: flex;
  flex-wrap: wrap;
  gap: var(--skills-tags-gap);
}

.status-tag {
    cursor: pointer;
    padding: 8px 14px;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    border: 1.5px solid transparent;
    transition: background-color 0.2s, color 0.2s, border-color 0.2s;
    background-color: var(--secondary-bg-color, var(--tg-theme-secondary-bg-color, #efefef));
    color: var(--main-text-color, var(--tg-theme-text-color, #000000));
}

.status-tag.active {
    color: #ffffff;
    border-color: transparent !important;
}

.status-tag[data-status="looking"] { border-color: #0A84FF; color: #0A84FF; }
.status-tag[data-status="looking"].active { background-color: #0A84FF; }
.status-tag[data-status="offering"] { border-color: #34C759; color: #34C759; }
.status-tag[data-status="offering"].active { background-color: #34C759; }
.status-tag[data-status="showcase"] { border-color: #FF9500; color: #FF9500; }
.status-tag[data-status="showcase"].active { background-color: #FF9500; }

body.theme-dark .status-tag {
    background-color: var(--secondary-bg-color, #2c2c2e);
    color: var(--main-hint-color, #98989e);
}
body.theme-dark .status-tag[data-status="looking"] { border-color: #0A84FF; color: #0A84FF; }
body.theme-dark .status-tag[data-status="offering"] { border-color: #34C759; color: #34C759; }
body.theme-dark .status-tag[data-status="showcase"] { border-color: #FF9500; color: #FF9500; }
body.theme-dark .status-tag.active { color: #ffffff; }

/* --- HTML СТЕКЛО --- */
body.theme-glass-overlay .modal-overlay { background-color: rgba(0, 0, 0, 0.4); }
body.theme-glass-overlay .modal-content {
    background-color: var(--glass-bg);
    backdrop-filter: blur(25px);
    -webkit-backdrop-filter: blur(25px);
    border: var(--glass-border);
    box-shadow: var(--glass-shadow);
    border-radius: var(--glass-radius-main);
}

#create-post-modal {
  display: none;
  flex-direction: column;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  height: 100dvh;
  height: 100vh;
  z-index: 1001;
  padding: calc(var(--safe-area-inset-top) + var(--header-offset)) 0 0 0;
  
  background-color: var(--main-bg-color, var(--tg-theme-bg-color, #ffffff));
  transition: background-color 0.3s;
}

#create-post-modal .form-header {
  padding: 0 20px 10px 20px;
  margin-bottom: 0;
  flex-shrink: 0;
}

#create-post-modal .form-content {
  flex: 1;
  overflow-y: auto;
  padding: 0 20px;
  padding-bottom: 120px;
  min-height: 0;
}

body.theme-glass-overlay #skills-modal,
body.theme-glass-overlay #create-post-modal {
    background-color: var(--main-bg-color);
}

/* Читаемость текста в стекле */
body.theme-glass-overlay .skill-category-title,
body.theme-glass-overlay .status-filter-group-title {
    color: var(--main-text-color);
    opacity: 0.9;
    text-shadow: 0 1px 2px rgba(0,0,0,0.3);
}

body.theme-glass-overlay .status-tag {
    background-color: var(--glass-bg-input);
    border: var(--glass-border);
    color: #ffffff; 
    opacity: 1; 
    text-shadow: 0 1px 2px rgba(0,0,0,0.2);
}
body.theme-glass-overlay .status-tag.active {
    opacity: 1;
    color: #ffffff;
    border-color: transparent;
    box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

body.theme-glass-overlay .action-button.fab-modal-save {
    background-color: var(--main-button-color);
    color: var(--main-button-text-color);
    border: none;
    box-shadow: var(--glass-shadow);
}

/* --- REACT МОДАЛКИ --- */
.react-sheet-content {
    background-color: var(--secondary-bg-color, #efefef);
    transition: background-color 0.3s;
    will-change: transform; 
    transform: translateZ(0);
    backface-visibility: hidden;
    
    /* Разрешаем нативный скролл */
    touch-action: pan-y; 
    -webkit-overflow-scrolling: touch;
}

body.theme-dark .react-sheet-content {
    background-color: var(--secondary-bg-color, #2c2c2e);
}

body.theme-glass-overlay .react-sheet-content {
    background-color: var(--glass-bg);
    backdrop-filter: blur(25px);
    -webkit-backdrop-filter: blur(25px);
    border-top: var(--glass-border);
    border-left: var(--glass-border);
    border-right: var(--glass-border);
    box-shadow: var(--glass-shadow);
}

body.theme-glass-overlay .react-sheet-content.is-ios {
    background-color: var(--glass-bg-ios-fallback);
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
}

.react-sheet-actions-button {
    position: absolute;
    top: 16px;
    left: 16px;
    z-index: 10;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    border: none;
    cursor: pointer;
    background-color: var(--secondary-bg-color, #efefef);
    color: var(--main-hint-color, #999999);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    font-size: 20px;
    line-height: 1;
    transition: all 0.3s;
}
.react-sheet-actions-button:active { transform: scale(0.9); }

body.theme-dark .react-sheet-actions-button {
    background-color: var(--main-bg-color, #1c1c1d);
    color: var(--main-hint-color, #98989e);
}

body.theme-glass-overlay .react-sheet-actions-button {
    background-color: var(--glass-bg-secondary);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    border: var(--glass-border);
    color: var(--main-text-color);
    opacity: 0.8;
}

body.theme-glass-overlay .react-sheet-actions-button.is-ios {
    background-color: var(--glass-bg-ios-fallback-secondary);
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
}

.react-sheet-chevron-close {
    position: absolute;
    top: -15px; 
    left: 50%;
    transform: translateX(-50%);
    z-index: 10;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    background-color: var(--secondary-bg-color, #efefef);
    color: var(--main-hint-color, #999999);
    border: 1.5px solid var(--main-bg-color, #fff);
    box-shadow: 0 -2px 10px rgba(0,0,0,0.08);
    transition: all 0.3s;
}
.react-sheet-chevron-close svg { width: 20px; height: 20px; }
.react-sheet-chevron-close:active { transform: translateX(-50%) scale(0.9); }

body.theme-dark .react-sheet-chevron-close {
    background-color: var(--secondary-bg-color, #2c2c2e);
    color: var(--main-hint-color, #98989e);
    border: 1.5px solid var(--main-bg-color, #1c1c1d);
}

body.theme-glass-overlay .react-sheet-chevron-close {
    background-color: var(--glass-bg-secondary);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: var(--glass-border);
    color: #ffffff; 
    opacity: 1;
    box-shadow: var(--glass-shadow);
}

body.theme-glass-overlay .react-sheet-chevron-close.is-ios {
    background-color: var(--glass-bg-ios-fallback-secondary);
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
}

/* --- ПАЛОЧКА (Handle) --- */
.react-sheet-handle-wrapper {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    /* Увеличенная зона свайпа (60px) */
    height: 60px; 
    display: flex;
    /* Палочка выше (отступ 8px) */
    align-items: flex-start;
    padding-top: 8px;
    justify-content: center;
    z-index: 25;
    cursor: grab;
    touch-action: none; /* Запрет браузерного скролла */
}

.react-sheet-handle-bar {
    width: 64px; 
    height: 5px;
    border-radius: 100px;
    background-color: var(--secondary-bg-color, #efefef);
    filter: brightness(0.85);
    box-shadow: 0 1px 3px rgba(0,0,0,0.15);
}

body.theme-dark .react-sheet-handle-bar {
    background-color: rgba(255, 255, 255, 0.2);
}

body.theme-glass-overlay .react-sheet-handle-bar {
    background-color: rgba(255, 255, 255, 0.5);
    backdrop-filter: blur(5px);
}

/* --- Sticky Footer --- */
.sheet-footer {
    background-color: var(--secondary-bg-color, #efefef);
    position: relative;
    z-index: 10;
    box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.05);
}

body.theme-dark .sheet-footer {
    background-color: var(--secondary-bg-color, #2c2c2e);
    box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.2);
}

body.theme-glass-overlay .sheet-footer {
    background-color: var(--glass-bg-secondary);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-top: var(--glass-border);
    box-shadow: none;
}

body.theme-glass-overlay .action-button {
    background-color: var(--main-button-color); 
    color: #ffffff;
    border: none;
    box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

body.theme-glass-overlay .action-button.secondary {
    background-color: var(--glass-bg-input);
    color: #ffffff;
    border: var(--glass-border);
    backdrop-filter: blur(10px);
}

body.theme-glass-overlay .action-button:active,
body.theme-glass-overlay .action-button.secondary:active {
    opacity: 0.8;
    transform: scale(0.98);
}

/* === ANTI-SELECT === */
.react-sheet-content * {
    -webkit-user-select: none !important;
    -moz-user-select: none !important;
    -ms-user-select: none !important;
    user-select: none !important;
    -webkit-touch-callout: none !important;
    -webkit-user-drag: none !important;
    user-drag: none !important;
    -webkit-tap-highlight-color: transparent !important;
}
.react-sheet-content input,
.react-sheet-content textarea,
.react-sheet-content select {
    -webkit-user-select: text !important;
    -moz-user-select: text !important;
    -ms-user-select: text !important;
    user-select: text !important;
    -webkit-touch-callout: default !important;
}
.react-sheet-content select {
    -webkit-user-select: default !important;
    user-select: default !important;
}

/* --- УЛУЧШЕНИЕ ЦВЕТНЫХ КНОПОК (СТЕКЛО 60%) --- */
/* Замени этим кодом предыдущий блок в конце css/modals.css */

/* 1. База: белый текст, тень */
body.theme-dark.theme-glass-overlay .status-tag {
    font-weight: 600;
    color: #ffffff !important;
    text-shadow: 0 1px 2px rgba(0,0,0,0.4);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    border-width: 1px;
    border-style: solid;
    transition: all 0.2s ease;
}

/* 2. СИНИЙ (Ищу специалиста) */
body.theme-dark.theme-glass-overlay .status-tag[data-status="looking"] {
    background-color: rgba(10, 132, 255, 0.15);
    border-color: rgba(10, 132, 255, 0.4);
}
/* Активный: 60% непрозрачности */
body.theme-dark.theme-glass-overlay .status-tag[data-status="looking"].active {
    background-color: rgba(10, 132, 255, 0.6); 
    border-color: rgba(10, 132, 255, 0.9);
    box-shadow: 0 4px 15px rgba(10, 132, 255, 0.4);
}

/* 3. ЗЕЛЕНЫЙ (Предлагаю услуги) */
body.theme-dark.theme-glass-overlay .status-tag[data-status="offering"] {
    background-color: rgba(52, 199, 89, 0.15);
    border-color: rgba(52, 199, 89, 0.4);
}
/* Активный: 60% непрозрачности */
body.theme-dark.theme-glass-overlay .status-tag[data-status="offering"].active {
    background-color: rgba(52, 199, 89, 0.6);
    border-color: rgba(52, 199, 89, 0.9);
    box-shadow: 0 4px 15px rgba(52, 199, 89, 0.4);
}

/* 4. ОРАНЖЕВЫЙ (Демонстрация) */
body.theme-dark.theme-glass-overlay .status-tag[data-status="showcase"] {
    background-color: rgba(255, 149, 0, 0.15);
    border-color: rgba(255, 149, 0, 0.4);
}
/* Активный: 60% непрозрачности */
body.theme-dark.theme-glass-overlay .status-tag[data-status="showcase"].active {
    background-color: rgba(255, 149, 0, 0.6);
    border-color: rgba(255, 149, 0, 0.9);
    box-shadow: 0 4px 15px rgba(255, 149, 0, 0.4);
}

/* --- GLASS MODE TEXT FIXES (Заголовки как в модалке навыков) --- */
body.theme-dark.theme-glass-overlay h1, 
body.theme-dark.theme-glass-overlay h2,
body.theme-dark.theme-glass-overlay .form-header h1 {
    color: #ffffff !important;
    opacity: 1;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5); /* Тень для читаемости на пестром фоне */
}