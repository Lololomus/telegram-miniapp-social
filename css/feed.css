/* css/feed.css */
/* ОБНОВЛЕНО: Удалены дублирующиеся стили тегов */
/* ОБНОВЛЕНО (Glass): Добавлены "стеклянные" стили для карточек и поиска */
/* ✅ ИЗМЕНЕНИЕ: Удалены стили .post-actions-button и .post-actions-menu */
/* ✅ ИСПРАВЛЕНИЕ #8: Добавлен отступ для карточки MyPostCard */
/* ✅ ИСПРАВЛЕНИЕ (Item 1): Уменьшен gap в .feed-list с 15px до 12px */
/* ✅ ИСПРАВЛЕНИЕ (Item 2): Изменены стили .feed-card-skills-more для выравнивания */
/* ✅ НОВОЕ (Long-Press Menu): Добавлены стили для .post-context-menu-* */
/* ✅ ИСПРАВЛЕНИЕ (Long-Press Bug): Добавлен user-select: none */
/* ✅ ИСПРАВЛЕНИЕ (Long-Press Menu v2): Стили меню-листа заменены на стили плавающего меню */

/* --- ЛЕНТА --- */
.feed-list {
    display: flex;
    flex-direction: column;
    gap: 12px; /* ✅ ИСПРАВЛЕНИЕ (Item 1): Уменьшен gap с 15px до 12px */
    width: 100%;
}

/* --- СТИЛИ ДЛЯ ФИЛЬТРА ЛЕНТЫ --- */
.feed-filter {
    width: 100%;
    margin-bottom: 8px;
}
#feed-search-input { /* ID используется и для ленты людей, и для постов */
    width: 100%;
    padding: 14px 18px;
    font-size: 16px;
    border-radius: 10px;
    border: 1.5px solid var(--secondary-bg-color, var(--tg-theme-secondary-bg-color, #efefef));
    background-color: var(--secondary-bg-color, var(--tg-theme-secondary-bg-color, #efefef));
    color: var(--main-text-color, var(--tg-theme-text-color, #000000));
    transition: border-color 0.2s ease-out, background-color 0.2s ease-out;
}
#posts-search-input { /* Отдельный ID для поля поиска в постах */
    width: 100%;
    padding: 14px 18px;
    font-size: 16px;
    border-radius: 10px;
    border: 1.5px solid var(--secondary-bg-color, var(--tg-theme-secondary-bg-color, #efefef));
    background-color: var(--secondary-bg-color, var(--tg-theme-secondary-bg-color, #efefef));
    color: var(--main-text-color, var(--tg-theme-text-color, #000000));
    transition: border-color 0.2s ease-out, background-color 0.2s ease-out;
}

#feed-search-input:focus,
#posts-search-input:focus {
    outline: none;
    border-color: var(--main-button-color, var(--tg-theme-button-color, #007aff));
    background-color: var(--main-bg-color, var(--tg-theme-bg-color, #ffffff));
}

/* --- Стили для Быстрых фильтров (в ленте людей и постов) --- */
.quick-filters { /* Используется обоими React-компонентами */
    margin-top: 0;
    display: flex;
    flex-wrap: nowrap;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    padding-bottom: 10px;
    width: 100%;
    justify-content: flex-start;
    min-width: 0;
}
/* УДАЛЕНЫ БЛОКИ:
   .quick-filters .skill-tag
   .quick-filters .skill-tag.is-selected
   Они теперь .skill-tag--filter в /css/components/tags.css 
*/
.quick-filters::-webkit-scrollbar { height: 4px; }
.quick-filters::-webkit-scrollbar-track { background: transparent; }
.quick-filters::-webkit-scrollbar-thumb { background-color: var(--secondary-bg-color, #ccc); border-radius: 2px; }

/* --- СТИЛИ ДЛЯ SKELETON-ЗАГРУЗКИ --- */
.skeleton-card {
    background-color: var(--secondary-bg-color, var(--tg-theme-secondary-bg-color, #efefef));
    border-radius: 12px;
    padding: 15px;
    display: flex;
    align-items: center;
    gap: 15px;
    width: 100%;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    overflow: hidden;
    position: relative; /* Для анимации */
}
/* Эффект "мерцания" */
.skeleton-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(
        to right,
        transparent 0%,
        var(--main-bg-color, #ffffff) 50%,
        transparent 100%
    );
    opacity: 0.15;
    animation: shimmer 1.5s infinite linear;
}
.skeleton-avatar {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background-color: var(--main-bg-color, #ffffff);
    flex-shrink: 0;
    opacity: 0.3;
}
.skeleton-info {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    gap: 8px;
}
.skeleton-line {
    width: 100%;
    height: 16px;
    border-radius: 4px;
    background-color: var(--main-bg-color, #ffffff);
    opacity: 0.3;
}
.skeleton-line.short { width: 60%; }

/* --- Стили для React-карточек (FeedCard в react-feed.js и PostCard в react-posts-feed.js) --- */
/* Используется обоими компонентами */
.react-feed-card {
    /* Базовые стили для светлой темы и "Авто" */
    background-color: var(--secondary-bg-color, var(--tg-theme-secondary-bg-color, #efefef));
    border: 1px solid var(--main-bg-color, var(--tg-theme-bg-color, #ffffff));
    /* Плавная смена темы */
    transition: background-color 0.3s, border-color 0.3s, box-shadow 0.3s;
    /* ✅ ИСПРАВЛЕНИЕ #8: Отступ УБРАН отсюда и перенесен в .feed-list (gap)
       и в MyPostCard (margin-bottom) */
    /* margin-bottom: 15px; */
    
    /* ✅ ИСПРАВЛЕНИЕ (Long-Press Bug): Запрещаем выделение текста */
    -webkit-user-select: none; /* Safari */
    -moz-user-select: none; /* Firefox */
    -ms-user-select: none; /* IE10+ */
    user-select: none; /* Standard */
}
/* .react-feed-card:last-child { margin-bottom: 0; } */ /* <-- УДАЛЕНО */

/* УДАЛЕН БЛОК:
   .feed-card-skill (и его :hover, .dark, .custom)
   Он теперь .skill-tag--display в /css/components/tags.css 
*/


/* --- Стили для контейнера навыков и "+X" (используется только в react-feed.js) --- */
.feed-card-skills-container {
    margin-top: 10px;
    display: flex;
    flex-wrap: wrap; /* Allow wrapping *within* the line before overflow */
    gap: 6px;
    max-height: 2.3em; /* <-- ВОССТАНОВЛЕНО (подбери точное значение, ~1 строка) */
    overflow: hidden; /* <-- ВОССТАНОВЛЕНО */
    position: relative; /* Для позиционирования "+X" */
    min-height: 1.5em; /* Можно оставить */
    
    /* ✅ ИСПРАВЛЕНИЕ (Item 2): Выравниваем элементы по центру */
    align-items: center;
}
.feed-card-skills-more {
    position: absolute;
    right: 0;
    /* ✅ ИСПРАВЛЕНИЕ (Item 2): Убрано 'bottom: 0' */
    
    /* ✅ ИСПРАВЛЕНИЕ (Item 2): Стили для имитации тега */
    height: 28px; /* Match skill-tag height */
    display: inline-flex;
    align-items: center;
    border-radius: 14px; /* Match skill-tag radius */
    padding: 0 10px; /* Horizontal padding only */

    font-size: 13px;
    font-weight: 500;
    color: var(--main-hint-color);
    background: var(--secondary-bg-color, var(--tg-theme-secondary-bg-color, #efefef)); /* Match card background */
    line-height: 1;
    flex-shrink: 0;
    
    /* Плавный градиент для перекрытия (если нужно) */
    padding-left: 15px;
    background: linear-gradient(to right, 
        transparent 0%, 
        var(--secondary-bg-color, var(--tg-theme-secondary-bg-color, #efefef)) 30%
    );
}

/* Dark theme for +X */
body.theme-dark .feed-card-skills-more {
    background: linear-gradient(to right, 
        transparent 0%, 
        var(--secondary-bg-color, #2c2c2e) 30%
    );
}
/* Custom theme for +X */
body.theme-custom .feed-card-skills-more {
    background: linear-gradient(to right, 
        transparent 0%, 
        var(--secondary-bg-color) 30%
    );
}

/* УДАЛЕНЫ БЛОКИ:
   body.theme-dark .quick-filters .skill-tag
   body.theme-custom .quick-filters .skill-tag
   (и их .is-selected)
   Они теперь в /css/components/tags.css 
*/

/* --- (НОВЫЙ БЛОК) Стили для "Стекла" --- */

body.theme-glass-overlay .react-feed-card {
    background-color: var(--glass-bg);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: var(--glass-border);
    box-shadow: var(--glass-shadow);
    border-radius: var(--glass-radius-nested); /* 16px */
}

body.theme-glass-overlay #feed-search-input,
body.theme-glass-overlay #posts-search-input {
    background-color: var(--glass-bg-input);
    border: var(--glass-border);
    color: var(--main-text-color);
    border-radius: 12px;
}
body.theme-glass-overlay #feed-search-input:focus,
body.theme-glass-overlay #posts-search-input:focus {
    background-color: transparent;
    border-color: var(--main-button-color);
}
body.theme-glass-overlay #feed-search-input::placeholder,
body.theme-glass-overlay #posts-search-input::placeholder {
    color: var(--main-text-color);
    opacity: 0.7;
}

body.theme-glass-overlay .skeleton-card {
    background-color: var(--glass-bg);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: var(--glass-border);
    box-shadow: var(--glass-shadow);
    border-radius: var(--glass-radius-nested);
}
body.theme-glass-overlay .skeleton-card::before {
    /* Анимация мерцания для стекла */
    background: linear-gradient(
        to right,
        transparent 0%,
        rgba(255,255,255,0.1) 50%,
        transparent 100%
    );
}
body.theme-glass-overlay .skeleton-avatar,
body.theme-glass-overlay .skeleton-line {
    background-color: var(--glass-bg-secondary);
    opacity: 0.8;
}

body.theme-glass-overlay .feed-card-skills-more {
    color: var(--main-text-color);
    opacity: 0.8;
    background: linear-gradient(to right, 
        transparent 0%, 
        var(--glass-bg) 30%
    );
}

/* --- ✅ ИЗМЕНЕНИЕ: Старые стили .post-actions-button и .post-actions-menu УДАЛЕНЫ --- */

/* --- ========================================================== --- */
/* --- ✅ НОВОЕ (Long-Press Menu v2): Новые стили для плавающего меню --- */
/* --- ========================================================== --- */

/* 1. ФОН (Backdrop)
  z-index: 2000
*/
.post-context-menu-backdrop {
    position: fixed;
    inset: 0;
    z-index: 2000; /* Под карточкой (2001) и меню (2002) */
    
    /* Эффект размытия и затемнения, как в iOS */
    -webkit-backdrop-filter: blur(4px);
    backdrop-filter: blur(4px);
    background-color: rgba(0, 0, 0, 0.3);
}

/* 2. КОНТЕЙНЕР МЕНЮ (Плавающий блок)
  z-index: 2002 
*/
.post-context-menu-container {
    /* Позиционируется через inline-стили (top/left/width) */
    z-index: 2002; /* Над карточкой (2001) */

    /* Стили фона, как у карточек, но непрозрачные */
    background-color: var(--main-bg-color, #ffffff);
    border-radius: 12px;
    /* Тень, чтобы меню "парило" */
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    overflow: hidden;
}

/* 3. ГРУППА КНОПОК */
.post-context-menu-group {
    display: flex;
    flex-direction: column;
    padding: 6px; /* Небольшой отступ от краев */
}

/* 4. КНОПКИ МЕНЮ */
.post-context-menu-button {
    display: flex; /* Для иконок */
    align-items: center;
    gap: 10px;
    
    font-family: inherit;
    font-size: 15px;
    font-weight: 500;
    padding: 10px 12px;
    text-align: left;
    
    color: var(--main-text-color, #000000);
    background: none;
    border: none;
    cursor: pointer;
    border-radius: 8px; /* Скругление при наведении */
    
    transition: background-color 0.1s ease-out;
}

/* 5. ПОДВЕДЕНИЕ КУРСОРА (Hover) / Нажатие (Active) */
.post-context-menu-button:active,
.post-context-menu-button:hover {
    /* Используем hint-color, он темнее/светлее фона */
    background-color: var(--main-hint-color, #999999);
    opacity: 0.6;
}

/* 6. КРАСНАЯ КНОПКА (Удалить) */
.post-context-menu-button.destructive {
    color: var(--main-destructive-color, #ff3b30);
}

.post-context-menu-button.destructive:active,
.post-context-menu-button.destructive:hover {
    background-color: var(--main-destructive-color, #ff3b30);
    color: #ffffff;
    opacity: 1;
}

/* --- Кнопка "Отмена" УДАЛЕНА --- */
/* .post-context-menu-button.cancel { ... } */


/* --- Темная тема для Меню v2 --- */
body.theme-dark .post-context-menu-container {
    background-color: #2c2c2e; /* Фон панели */
}
body.theme-dark .post-context-menu-button {
    color: var(--main-text-color, #ffffff);
}
body.theme-dark .post-context-menu-button:active,
body.theme-dark .post-context-menu-button:hover {
    background-color: var(--main-hint-color, #555555);
    opacity: 1;
}
body.theme-dark .post-context-menu-button.destructive {
    color: #FF453A;
}
body.theme-dark .post-context-menu-button.destructive:active,
body.theme-dark .post-context-menu-button.destructive:hover {
    background-color: #FF453A;
    color: #ffffff;
}

/* --- "Стекло" для Меню v2 --- */
body.theme-glass-overlay .post-context-menu-backdrop {
    /* Фон уже имеет backdrop-filter, просто меняем цвет */
    background-color: rgba(0, 0, 0, 0.4);
}
body.theme-glass-overlay .post-context-menu-container {
    background-color: var(--glass-bg-secondary);
    -webkit-backdrop-filter: blur(20px);
    backdrop-filter: blur(20px);
    border: var(--glass-border);
    box-shadow: var(--glass-shadow);
}
body.theme-glass-overlay .post-context-menu-button {
    color: var(--main-text-color);
}
body.theme-glass-overlay .post-context-menu-button:active,
body.theme-glass-overlay .post-context-menu-button:hover {
    background-color: var(--glass-bg-input); /* Полупрозрачный фон */
    opacity: 1;
}

/* Стекло + Темная тема */
body.theme-dark.theme-glass-overlay .post-context-menu-button.destructive {
    color: #FF453A;
}
body.theme-dark.theme-glass-overlay .post-context-menu-button.destructive:active,
body.theme-dark.theme-glass-overlay .post-context-menu-button.destructive:hover {
    background-color: #FF453A;
    color: #ffffff;
}